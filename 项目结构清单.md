# PPT转视频工具 - 项目结构清单

## 📁 项目概述
这是一个完整的PPT转视频教程生成工具，基于Python和Streamlit开发，支持模块化工作流处理。

## 🗂️ 项目结构

```
ppt_to_video/
├── 📄 main.py                    # 主应用入口文件
├── 📄 README.md                  # 项目说明文档
├── 📄 requirements.txt           # 依赖包列表
├── 📄 开发完成报告.md            # 开发总结报告
├── 📄 项目结构清单.md            # 当前文件
│
├── 📁 config/                    # 配置模块
│   ├── __init__.py
│   ├── settings.py               # 项目配置设置
│   └── logging_config.py         # 日志配置
│
├── 📁 core/                      # 核心业务逻辑模块
│   ├── __init__.py
│   ├── step01_ppt_parser.py      # 步骤1: PPT解析器
│   ├── step02_tts_generator.py   # 步骤2: 语音合成器
│   ├── step03_video_generator.py # 步骤3: 视频生成器
│   └── step04_subtitle_generator.py # 步骤4: 字幕生成器
│
├── 📁 ui/                        # 用户界面模块
│   ├── __init__.py
│   └── pages/                    # 页面组件
│       ├── __init__.py
│       ├── upload_page.py        # 文件上传页面 (主页面)
│       ├── workflow_page.py      # 工作流执行页面
│       └── preview_page.py       # 预览页面
│
├── 📁 utils/                     # 工具模块
│   ├── __init__.py
│   ├── file_manager.py           # 文件管理器
│   ├── logger.py                 # 日志工具
│   └── progress_tracker.py       # 进度跟踪器
│
├── 📁 uploads/                   # 上传文件存储目录
├── 📁 output/                    # 输出文件目录
│   └── logs/                     # 日志文件目录
├── 📁 testfile/                  # 测试文件目录
│   └── 测试文件.pptx
├── 📁 .github/                   # GitHub配置
│   └── copilot-instructions.md
├── 📁 .vscode/                   # VS Code配置
└── 📁 venv/                      # Python虚拟环境
```

## 🚀 核心功能

### 🎯 工作流步骤
1. **📋 PPT解析** (`step01_ppt_parser.py`)
   - 解析PPT文件结构
   - 提取幻灯片图片
   - 提取备注内容

2. **🎵 语音合成** (`step02_tts_generator.py`)
   - 将文本转换为语音
   - 支持多种语音选择
   - 可调节语速和音调

3. **🎬 视频生成** (`step03_video_generator.py`)
   - 基于幻灯片生成视频片段
   - 支持多种分辨率和帧率
   - 自动同步音频时长

4. **📄 字幕生成** (`step04_subtitle_generator.py`)
   - 生成SRT格式字幕
   - 自动计算时间轴
   - 支持字幕样式配置

5. **🎯 最终合并** (在 `upload_page.py` 中实现)
   - 合并所有媒体文件
   - 生成最终视频
   - 支持字幕嵌入

### 🔧 技术特性
- **异步处理**: 支持长时间任务的异步执行
- **进度跟踪**: 实时显示处理进度
- **错误处理**: 完整的异常处理和日志记录
- **断点续传**: 支持工作流程的中断和恢复
- **文件管理**: 结构化的文件存储和元数据管理

### 🌐 用户界面
- **Streamlit多页面应用**: 现代化的Web界面
- **侧边栏配置**: 所有设置集中在侧边栏
- **单步执行**: 支持逐步测试和调试
- **实时反馈**: 进度条和状态显示
- **文件下载**: 直接下载生成的视频

## 📋 已删除的文件

为了避免混淆，以下文件已被清理：

### 🗑️ 测试文件 (已删除)
- `test_*.py` - 所有开发阶段的测试文件
- `tests/` - 整个测试目录

### 🗑️ 重复应用文件 (已删除)
- `streamlit_app.py` - 旧版本的应用文件
- `streamlit_app_new.py` - 另一个版本的应用文件
- `view_excel.py` - Excel查看工具

### 🗑️ 不再使用的模块 (已删除)
- `core/step05_final_merger.py` - 独立的合并器(功能已集成到upload_page.py)

### 🗑️ 缓存文件 (已删除)
- `**/__pycache__/` - 所有Python缓存目录

## 🎮 如何使用

1. **启动应用**:
   ```bash
   streamlit run main.py
   ```

2. **工作流程**:
   - 上传PPT文件
   - 配置语音和视频参数
   - 逐步执行或一键执行完整流程
   - 下载生成的视频

3. **配置选项**:
   - 项目设置: 名称、输出格式
   - 语音设置: 语音选择、语速、音调
   - 视频设置: 分辨率、帧率、比特率、编码器
   - 字幕设置: 字体大小、颜色、位置

## 🔄 当前版本状态

- ✅ 核心功能完整实现
- ✅ Web界面优化完成
- ✅ 单步测试功能完成
- ✅ 项目文件结构清理完成
- ✅ 配置系统完善
- ✅ 错误处理和日志记录完整

项目现在处于功能完整、结构清晰的状态，可以正常使用和进一步开发。
